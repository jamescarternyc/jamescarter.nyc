!function(e,t){"use strict";function n(){$.iterate.call(x,l)}function i(){x=e(b.element)}function a(e){e.formatter||(e.formatter=m),e.min=parseFloat(this.attr("min"))||0,e.max=parseFloat(this.attr("max"))||100,e.step=parseFloat(this.attr("step"))||1,e.digits=e.step.toString().length-e.step.toString().indexOf("."),e.value=parseFloat(this.val())||e.min+(e.max-e.min)/2;var t="";e.vertical="vertical"===this.attr("orient")||e.vertical,e.disabled=this.is(":disabled"),t+='<div class="'+y.track+'">',e.fill&&(t+='<span class="'+y.fill+'"></span>'),t+='<div class="'+y.handle+'">',t+='<span class="'+y.marker+'"></span>',t+="</div>",t+="</div>";var n=[y.base,e.customClass,e.vertical?y.vertical:"",e.labels?y.labels:"",e.disabled?y.disabled:""];if(this.addClass(y.element).wrap('<div class="'+n.join(" ")+'"></div>').after(t),e.$container=this.parents(b.base),e.$track=e.$container.find(b.track),e.$fill=e.$container.find(b.fill),e.$handle=e.$container.find(b.handle),e.$output=e.$container.find(b.output),e.labels){var a='<span class="'+[y.label,y.label_max].join(" ")+'">'+e.formatter.call(this,e.labels.max?e.labels.max:e.max)+"</span>",o='<span class="'+[y.label,y.label_min].join(" ")+'">'+e.formatter.call(this,e.labels.max?e.labels.min:e.min)+"</span>";e.$container.prepend(e.vertical?a:o).append(e.vertical?o:a)}e.$labels=e.$container.find(b.label),this.on(w.focus,e,p).on(w.blur,e,f).on(w.change,e,g),e.$container.fsTouch({pan:!0,axis:e.vertical?"y":"x"}).on(w.panStart,e,c).on(w.pan,e,d).on(w.panEnd,e,u),i(),l.call(this,e)}function o(e){e.$container.off(w.namespace).fsTouch("destroy"),e.$track.remove(),e.$labels.remove(),this.unwrap().removeClass(y.element).off(w.namespace),i()}function r(e){e.disabled&&(this.prop("disabled",!1),e.$container.removeClass(y.disabled),e.disabled=!1)}function s(e){e.disabled||(this.prop("disabled",!0),e.$container.addClass(y.disabled),e.disabled=!0)}function l(e){e.stepCount=(e.max-e.min)/e.step,e.offset=e.$track.offset(),e.vertical?(e.trackHeight=e.$track.outerHeight(),e.handleHeight=e.$handle.outerHeight(),e.increment=e.trackHeight/e.stepCount):(e.trackWidth=e.$track.outerWidth(),e.handleWidth=e.$handle.outerWidth(),e.increment=e.trackWidth/e.stepCount);var t=(e.$el.val()-e.min)/(e.max-e.min);h(e,t,!0)}function c(e){$.killEvent(e);var t=e.data;t.disabled||(d(e),t.$container.addClass(y.focus))}function d(e){$.killEvent();var t=e.data,n=0;t.disabled||(n=t.vertical?1-(e.pageY-t.offset.top)/t.trackHeight:(e.pageX-t.offset.left)/t.trackWidth,h(t,n))}function u(e){$.killEvent(e);var t=e.data;t.disabled||t.$container.removeClass(y.focus)}function p(e){e.data.$container.addClass("focus")}function f(e){e.data.$container.removeClass("focus")}function h(e,t,n){e.increment>1&&(t=e.vertical?Math.round(t*e.stepCount)*e.increment/e.trackHeight:Math.round(t*e.stepCount)*e.increment/e.trackWidth),0>t&&(t=0),t>1&&(t=1);var i=(e.min-e.max)*t;i=-parseFloat(i.toFixed(e.digits)),e.$fill.css(e.vertical?"height":"width",100*t+"%"),e.$handle.css(e.vertical?"bottom":"left",100*t+"%"),i+=e.min,i!==e.value&&i&&n!==!0&&(e.$el.val(i).trigger(w.change,[!0]),e.value=i)}function g(e,t){var n=e.data;if(!t&&!n.disabled){var i=(n.$el.val()-n.min)/(n.max-n.min);h(n,i)}}function m(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}var v=t.Plugin("range",{widget:!0,defaults:{customClass:"",fill:!1,formatter:!1,labels:{max:!1,min:!1},vertical:!1},classes:["track","handle","fill","marker","labels","label","label_min","label_max","vertical","focus","disabled"],methods:{_construct:a,_destruct:o,_resize:n,enable:r,disable:s,resize:l}}),b=v.classes,y=b.raw,w=v.events,$=v.functions,x=[]}(jQuery,Formstone);