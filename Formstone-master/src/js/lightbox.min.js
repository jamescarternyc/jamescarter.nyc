!function(e,t,i){"use strict";function n(){U=t.$body,Q=e("html, body")}function a(){K&&c()}function o(e){this.on(X.click,e,l)}function r(e){d(),this.off(X.namespace)}function s(t,i){t instanceof e&&l.apply(V,[{data:e.extend(!0,{},{$object:t},F,i||{})}])}function l(i){if(!K){var n=i.data,a=n.$el,o=n.$object,r=a&&a[0].href?a[0].href||"":"",s=a&&a[0].hash?a[0].hash||"":"",l=r.toLowerCase().split(".").pop().split(/\#|\?/),c=l[0],u=a?a.data(z+"-type"):"",p="image"===u||e.inArray(c,n.extensions)>-1||"data:image"===r.substr(0,10),h=A(r),m="url"===u||!p&&!h&&"http"===r.substr(0,4)&&!s,v="element"===u||!p&&!h&&!m&&"#"===s.substr(0,1),y="undefined"!=typeof o;if(v&&(r=s),!(p||h||m||v||y))return;if(Y.killEvent(i),K=e.extend({},{visible:!1,gallery:{active:!1},isMobile:t.isMobile||n.mobile,isTouch:t.support.touch,isAnimating:!0,oldContentHeight:0,oldContentWidth:0},n),K.touch=n.touch&&K.isMobile&&K.isTouch,K.margin*=2,p?K.type="image":h?K.type="video":K.type="element",p||h){var w=a.data(z+"-gallery");w&&(K.gallery.active=!0,K.gallery.id=w,K.gallery.$items=e("a[data-lightbox-gallery= "+K.gallery.id+"], a[rel= "+K.gallery.id+"]"),K.gallery.index=K.gallery.$items.index(K.$el),K.gallery.total=K.gallery.$items.length-1)}var $="";K.isMobile||($+='<div class="'+[R.raw.overlay,K.customClass].join(" ")+'"></div>');var x=[R.raw.base,R.raw.loading,R.raw.animating,K.customClass];K.fixed&&x.push(R.raw.fixed),K.isMobile&&x.push(R.raw.mobile),K.isTouch&&x.push(R.raw.touch),m&&x.push(R.raw.iframed),(v||y)&&x.push(R.raw.inline),$+='<div class="'+x.join(" ")+'">',$+='<button type="button" class="'+R.raw.close+'">'+K.labels.close+"</button>",$+='<span class="'+R.raw.loading_icon+'"></span>',$+='<div class="'+R.raw.container+'">',$+='<div class="'+R.raw.content+'">',(p||h)&&($+='<div class="'+R.raw.tools+'">',$+='<div class="'+R.raw.controls+'">',K.gallery.active&&($+='<button type="button" class="'+[R.raw.control,R.raw.control_previous].join(" ")+'">'+K.labels.previous+"</button>",$+='<button type="button" class="'+[R.raw.control,R.raw.control_next].join(" ")+'">'+K.labels.next+"</button>"),K.isMobile&&K.isTouch&&($+='<button type="button" class="'+[R.raw.caption_toggle].join(" ")+'">'+K.labels.captionClosed+"</button>"),$+="</div>",$+='<div class="'+R.raw.meta+'">',K.gallery.active&&($+='<p class="'+R.raw.position+'"',K.gallery.total<1&&($+=' style="display: none;"'),$+=">",$+='<span class="'+R.raw.position_current+'">'+(K.gallery.index+1)+"</span> ",$+=K.labels.count,$+=' <span class="'+R.raw.position_total+'">'+(K.gallery.total+1)+"</span>",$+="</p>"),$+='<div class="'+R.raw.caption+'">',$+=K.formatter.call(a,n),$+="</div></div>",$+="</div>"),$+="</div></div></div>",U.append($),K.$overlay=e(R.overlay),K.$lightbox=e(R.base),K.$close=e(R.close),K.$container=e(R.container),K.$content=e(R.content),K.$tools=e(R.tools),K.$meta=e(R.meta),K.$position=e(R.position),K.$caption=e(R.caption),K.$controlBox=e(R.controls),K.$controls=e(R.control),K.isMobile?(K.paddingVertical=K.$close.outerHeight(),K.paddingHorizontal=0,K.mobilePaddingVertical=parseInt(K.$content.css("paddingTop"),10)+parseInt(K.$content.css("paddingBottom"),10),K.mobilePaddingHorizontal=parseInt(K.$content.css("paddingLeft"),10)+parseInt(K.$content.css("paddingRight"),10)):(K.paddingVertical=parseInt(K.$lightbox.css("paddingTop"),10)+parseInt(K.$lightbox.css("paddingBottom"),10),K.paddingHorizontal=parseInt(K.$lightbox.css("paddingLeft"),10)+parseInt(K.$lightbox.css("paddingRight"),10),K.mobilePaddingVertical=0,K.mobilePaddingHorizontal=0),K.contentHeight=K.$lightbox.outerHeight()-K.paddingVertical,K.contentWidth=K.$lightbox.outerWidth()-K.paddingHorizontal,K.controlHeight=K.$controls.outerHeight(),f(),K.gallery.active&&(K.$lightbox.addClass(B.has_controls),_()),G.on(X.keyDown,j),U.on(X.click,[R.overlay,R.close].join(", "),d),K.gallery.active&&K.$lightbox.on(X.click,R.control,M),K.isMobile&&K.isTouch&&K.$lightbox.on(X.click,R.caption_toggle,g),K.$lightbox.fsTransition({property:"opacity"},function(){p?b(r):h?H(r):m?I(r):v?S(r):y&&P(K.$object)}).addClass(R.raw.open),K.$overlay.addClass(R.raw.open)}}function c(e){"object"!=typeof e&&(K.targetHeight=arguments[0],K.targetWidth=arguments[1]),"element"===K.type?D(K.$content.find("> :first-child")):"image"===K.type?k():"video"===K.type&&W(),p()}function d(e){Y.killEvent(e),K&&(K.$lightbox.fsTransition("destroy"),K.$container.fsTransition("destroy"),y(),K.$lightbox.addClass(R.raw.animating).fsTransition({property:"opacity"},function(e){K.$lightbox.off(X.namespace),K.$container.off(X.namespace),G.off(X.namespace),U.off(X.namespace),K.$overlay.remove(),K.$lightbox.remove(),K=null,G.trigger(X.close)}),K.$lightbox.removeClass(R.raw.open),K.$overlay.removeClass(R.raw.open),K.isMobile&&Q.removeClass(B.lock))}function u(){var e=h();K.isMobile?0:K.duration;K.isMobile||K.$controls.css({marginTop:(K.contentHeight-K.controlHeight-K.metaHeight)/2}),K.$lightbox.fsTransition({property:K.contentHeight!==K.oldContentHeight?"height":"width"},function(){K.$container.fsTransition({property:"opacity"},function(){K.$lightbox.removeClass(R.raw.animating),K.isAnimating=!1}),K.$lightbox.removeClass(R.raw.loading),K.visible=!0,G.trigger(X.open),K.gallery.active&&E()}),K.isMobile||K.$lightbox.css({height:K.contentHeight+K.paddingVertical,width:K.contentWidth+K.paddingHorizontal,top:K.fixed?0:e.top});var i=K.oldContentHeight!==K.contentHeight||K.oldContentWidth!==K.contentWidth;(K.isMobile||!i)&&K.$lightbox.fsTransition("resolve"),K.oldContentHeight=K.contentHeight,K.oldContentWidth=K.contentWidth,K.isMobile&&Q.addClass(B.lock)}function p(){if(K.visible&&!K.isMobile){var e=h();K.$controls.css({marginTop:(K.contentHeight-K.controlHeight-K.metaHeight)/2}),K.$lightbox.css({height:K.contentHeight+K.paddingVertical,width:K.contentWidth+K.paddingHorizontal,top:K.fixed?0:e.top})}}function f(){var e=h();K.$lightbox.css({top:K.fixed?0:e.top})}function h(){if(K.isMobile)return{left:0,top:0};var e={left:(t.windowWidth-K.contentWidth-K.paddingHorizontal)/2,top:K.top<=0?(t.windowHeight-K.contentHeight-K.paddingVertical)/2:K.top};return K.fixed!==!0&&(e.top+=G.scrollTop()),e}function g(e){Y.killEvent(e),K.captionOpen?m():(K.$lightbox.addClass(R.raw.caption_open).find(R.caption_toggle).text(K.labels.captionOpen),K.captionOpen=!0)}function m(){K.$lightbox.removeClass(R.raw.caption_open).find(R.caption_toggle).text(K.labels.captionClosed),K.captionOpen=!1}function v(){var e=this.attr("title"),t=e!==i&&e?e.replace(/^\s+|\s+$/g,""):!1;return t?'<p class="caption">'+t+"</p>":""}function b(t){K.hasScaled=!1,K.$imageContainer=e('<div class="'+R.raw.image_container+'"><img></div>'),K.$image=K.$imageContainer.find("img"),K.$image.one(X.load,function(){var e=q(K.$image);K.naturalHeight=e.naturalHeight,K.naturalWidth=e.naturalWidth,K.retina&&(K.naturalHeight/=2,K.naturalWidth/=2),K.$content.prepend(K.$imageContainer),""===K.$caption.html()?(K.$caption.hide(),K.$lightbox.removeClass(B.has_caption)):(K.$caption.show(),K.$lightbox.addClass(B.has_caption)),k(),u(),K.touch&&(w(),x({scale:1,deltaX:0,deltaY:0}),C(),K.$container.fsTouch({pan:!0,scale:!0}).on(X.scaleStart,$).on(X.scaleEnd,C).on(X.scale,x))}).error(O).attr("src",t).addClass(R.raw.image),(K.$image[0].complete||4===K.$image[0].readyState)&&K.$image.trigger(X.load)}function y(){K.$image&&K.$image.length&&K.$container.fsTouch("destroy")}function w(){K.scalePosition=K.$imageContainer.position(),K.scaleY=K.scalePosition.top,K.scaleX=K.scalePosition.left,K.scaleHeight=K.$image.outerHeight(),K.scaleWidth=K.$image.outerWidth()}function $(e){w(),K.$lightbox.removeClass(R.raw.animating)}function x(e){K.targetContainerY=K.scaleY+e.deltaY,K.targetContainerX=K.scaleX+e.deltaX,K.targetImageHeight=K.scaleHeight*e.scale,K.targetImageWidth=K.scaleWidth*e.scale,K.targetImageHeight<K.scaleMinHeight&&(K.targetImageHeight=K.scaleMinHeight),K.targetImageHeight>K.scaleMaxHeight&&(K.targetImageHeight=K.scaleMaxHeight),K.targetImageWidth<K.scaleMinWidth&&(K.targetImageWidth=K.scaleMinWidth),K.targetImageWidth>K.scaleMaxWidth&&(K.targetImageWidth=K.scaleMaxWidth),K.hasScaled=!0,K.isScaling=!0,K.$imageContainer.css({top:K.targetContainerY,left:K.targetContainerX}),K.$image.css({height:K.targetImageHeight,width:K.targetImageWidth,top:-(K.targetImageHeight/2),left:-(K.targetImageWidth/2)})}function C(e){w(),K.isScaling=!1;var t=K.$container.outerHeight()-K.metaHeight,i=K.$container.outerWidth();K.scaleMinY=t-K.scaleHeight/2,K.scaleMinX=i-K.scaleWidth/2,K.scaleMaxY=K.scaleHeight/2,K.scaleMaxX=K.scaleWidth/2,K.scaleHeight<t?K.scalePosition.top=t/2:(K.scalePosition.top<K.scaleMinY&&(K.scalePosition.top=K.scaleMinY),K.scalePosition.top>K.scaleMaxY&&(K.scalePosition.top=K.scaleMaxY)),K.scaleWidth<i?K.scalePosition.left=i/2:(K.scalePosition.left<K.scaleMinX&&(K.scalePosition.left=K.scaleMinX),K.scalePosition.left>K.scaleMaxX&&(K.scalePosition.left=K.scaleMaxX)),K.$lightbox.addClass(R.raw.animating),K.$imageContainer.css({left:K.scalePosition.left,top:K.scalePosition.top})}function k(){var e=0;for(K.windowHeight=K.viewportHeight=t.windowHeight-K.mobilePaddingVertical-K.paddingVertical,K.windowWidth=K.viewportWidth=t.windowWidth-K.mobilePaddingHorizontal-K.paddingHorizontal,K.contentHeight=1/0,K.contentWidth=1/0,K.imageMarginTop=0,K.imageMarginLeft=0;K.contentHeight>K.viewportHeight&&2>e;)K.imageHeight=0===e?K.naturalHeight:K.$image.outerHeight(),K.imageWidth=0===e?K.naturalWidth:K.$image.outerWidth(),K.metaHeight=0===e?0:K.metaHeight,K.spacerHeight=0===e?0:K.spacerHeight,0===e&&(K.ratioHorizontal=K.imageHeight/K.imageWidth,K.ratioVertical=K.imageWidth/K.imageHeight,K.isWide=K.imageWidth>K.imageHeight),K.imageHeight<K.minHeight&&(K.minHeight=K.imageHeight),K.imageWidth<K.minWidth&&(K.minWidth=K.imageWidth),K.isMobile?(K.isTouch?(K.$controlBox.css({width:t.windowWidth}),K.spacerHeight=K.$controls.outerHeight(!0)):(K.$tools.css({width:t.windowWidth}),K.spacerHeight=K.$tools.outerHeight(!0)),K.contentHeight=K.viewportHeight,K.contentWidth=K.viewportWidth,T(),K.imageMarginTop=(K.contentHeight-K.targetImageHeight-K.spacerHeight)/2,K.imageMarginLeft=(K.contentWidth-K.targetImageWidth)/2):(0===e&&(K.viewportHeight-=K.margin+K.paddingVertical,K.viewportWidth-=K.margin+K.paddingHorizontal),K.viewportHeight-=K.metaHeight,T(),K.contentHeight=K.targetImageHeight,K.contentWidth=K.targetImageWidth),K.isMobile||K.isTouch||K.$meta.css({width:K.contentWidth}),K.hasScaled||(K.$image.css({height:K.targetImageHeight,width:K.targetImageWidth}),K.touch?K.$image.css({top:-(K.targetImageHeight/2),left:-(K.targetImageWidth/2)}):K.$image.css({marginTop:K.imageMarginTop,marginLeft:K.imageMarginLeft})),K.isMobile||(K.metaHeight=K.$meta.outerHeight(!0),K.contentHeight+=K.metaHeight),e++;K.touch&&(K.scaleMinHeight=K.targetImageHeight,K.scaleMinWidth=K.targetImageWidth,K.scaleMaxHeight=K.naturalHeight,K.scaleMaxWidth=K.naturalWidth)}function T(){var e=K.isMobile?K.contentHeight-K.spacerHeight:K.viewportHeight,t=K.isMobile?K.contentWidth:K.viewportWidth;K.isWide?(K.targetImageWidth=t,K.targetImageHeight=K.targetImageWidth*K.ratioHorizontal,K.targetImageHeight>e&&(K.targetImageHeight=e,K.targetImageWidth=K.targetImageHeight*K.ratioVertical)):(K.targetImageHeight=e,K.targetImageWidth=K.targetImageHeight*K.ratioVertical,K.targetImageWidth>t&&(K.targetImageWidth=t,K.targetImageHeight=K.targetImageWidth*K.ratioHorizontal)),(K.targetImageWidth>K.imageWidth||K.targetImageHeight>K.imageHeight)&&(K.targetImageHeight=K.imageHeight,K.targetImageWidth=K.imageWidth),(K.targetImageWidth<K.minWidth||K.targetImageHeight<K.minHeight)&&(K.targetImageWidth<K.minWidth?(K.targetImageWidth=K.minWidth,K.targetImageHeight=K.targetImageWidth*K.ratioHorizontal):(K.targetImageHeight=K.minHeight,K.targetImageWidth=K.targetImageHeight*K.ratioVertical))}function H(t){var i=t.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i),n=t.match(/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/),a=t.split("?"),o=null!==i?"//www.youtube.com/embed/"+i[1]:"//player.vimeo.com/video/"+n[3];a.length>=2&&(o+="?"+a.slice(1)[0].trim()),K.$videoWrapper=e('<div class="'+R.raw.video_wrapper+'"></div>'),K.$video=e('<iframe class="'+R.raw.video+'" frameborder="0" seamless="seamless" allowfullscreen></iframe>'),K.$video.attr("src",o).addClass(R.raw.video).prependTo(K.$videoWrapper),K.$content.prepend(K.$videoWrapper),W(),u()}function W(){K.windowHeight=K.viewportHeight=t.windowHeight-K.mobilePaddingVertical-K.paddingVertical,K.windowWidth=K.viewportWidth=t.windowWidth-K.mobilePaddingHorizontal-K.paddingHorizontal,K.videoMarginTop=0,K.videoMarginLeft=0,K.isMobile?(K.isTouch?(K.$controlBox.css({width:t.windowWidth}),K.spacerHeight=K.$controls.outerHeight(!0)):(K.$tools.css({width:t.windowWidth}),K.spacerHeight=K.$tools.outerHeight(!0)),K.viewportHeight-=K.spacerHeight,K.targetVideoWidth=K.viewportWidth,K.targetVideoHeight=K.targetVideoWidth*K.videoRatio,K.targetVideoHeight>K.viewportHeight&&(K.targetVideoHeight=K.viewportHeight,K.targetVideoWidth=K.targetVideoHeight/K.videoRatio),K.videoMarginTop=(K.viewportHeight-K.targetVideoHeight)/2,K.videoMarginLeft=(K.viewportWidth-K.targetVideoWidth)/2):(K.viewportHeight=K.windowHeight-K.margin,K.viewportWidth=K.windowWidth-K.margin,K.targetVideoWidth=K.videoWidth>K.viewportWidth?K.viewportWidth:K.videoWidth,K.targetVideoWidth<K.minWidth&&(K.targetVideoWidth=K.minWidth),K.targetVideoHeight=K.targetVideoWidth*K.videoRatio,K.contentHeight=K.targetVideoHeight,K.contentWidth=K.targetVideoWidth),K.isMobile||K.isTouch||K.$meta.css({width:K.contentWidth}),K.$videoWrapper.css({height:K.targetVideoHeight,width:K.targetVideoWidth,marginTop:K.videoMarginTop,marginLeft:K.videoMarginLeft}),K.isMobile||(K.metaHeight=K.$meta.outerHeight(!0),K.contentHeight=K.targetVideoHeight+K.metaHeight)}function E(t){var i="";K.gallery.index>0&&(i=K.gallery.$items.eq(K.gallery.index-1).attr("href"),A(i)||e('<img src="'+i+'">')),K.gallery.index<K.gallery.total&&(i=K.gallery.$items.eq(K.gallery.index+1).attr("href"),A(i)||e('<img src="'+i+'">'))}function M(t){Y.killEvent(t);var i=e(t.currentTarget);K.isAnimating||i.hasClass(R.raw.control_disabled)||(K.isAnimating=!0,y(),m(),K.gallery.index+=i.hasClass(R.raw.control_next)?1:-1,K.gallery.index>K.gallery.total&&(K.gallery.index=K.infinite?0:K.gallery.total),K.gallery.index<0&&(K.gallery.index=K.infinite?K.gallery.total:0),K.$lightbox.addClass(R.raw.animating),K.$container.fsTransition({property:"opacity"},function(){"undefined"!=typeof K.$image&&K.$image.remove(),"undefined"!=typeof K.$videoWrapper&&K.$videoWrapper.remove(),K.$el=K.gallery.$items.eq(K.gallery.index),K.$caption.html(K.formatter.call(K.$el,K)),K.$position.find(R.position_current).html(K.gallery.index+1);var e=K.$el.attr("href"),t=A(e);t?H(e):b(e),_()}),K.$lightbox.addClass(R.raw.loading))}function _(){K.$controls.removeClass(R.raw.control_disabled),K.infinite||(0===K.gallery.index&&K.$controls.filter(R.control_previous).addClass(B.control_disabled),K.gallery.index===K.gallery.total&&K.$controls.filter(R.control_next).addClass(B.control_disabled))}function j(e){!K.gallery.active||37!==e.keyCode&&39!==e.keyCode?27===e.keyCode&&K.$close.trigger(X.click):(Y.killEvent(e),K.$controls.filter(37===e.keyCode?R.control_previous:R.control_next).trigger(X.click))}function S(t){var i=e(t).find("> :first-child").clone();P(i)}function I(t){t+=t.indexOf("?")>-1?"&"+K.requestKey+"=true":"?"+K.requestKey+"=true";var i=e('<iframe class="'+R.raw.iframe+'" src="'+t+'"></iframe>');P(i)}function P(e){K.$content.append(e),D(e),u()}function D(e){K.windowHeight=t.windowHeight-K.mobilePaddingVertical-K.paddingVertical,K.windowWidth=t.windowWidth-K.mobilePaddingHorizontal-K.paddingHorizontal,K.objectHeight=e.outerHeight(!0),K.objectWidth=e.outerWidth(!0),K.targetHeight=K.targetHeight||(K.$el?K.$el.data(z+"-height"):null),K.targetWidth=K.targetWidth||(K.$el?K.$el.data(z+"-width"):null),K.maxHeight=K.windowHeight<0?K.minHeight:K.windowHeight,K.isIframe=e.is("iframe"),K.objectMarginTop=0,K.objectMarginLeft=0,K.isMobile||(K.windowHeight-=K.margin,K.windowWidth-=K.margin),K.contentHeight=K.targetHeight?K.targetHeight:K.isIframe||K.isMobile?K.windowHeight:K.objectHeight,K.contentWidth=K.targetWidth?K.targetWidth:K.isIframe||K.isMobile?K.windowWidth:K.objectWidth,(K.isIframe||K.isObject)&&K.isMobile?(K.contentHeight=K.windowHeight,K.contentWidth=K.windowWidth):K.isObject&&(K.contentHeight=K.contentHeight>K.windowHeight?K.windowHeight:K.contentHeight,K.contentWidth=K.contentWidth>K.windowWidth?K.windowWidth:K.contentWidth)}function O(t){var i=e('<div class="'+R.raw.error+'"><p>Error Loading Resource</p></div>');K.type="element",K.$tools.remove(),K.$image.off(X.namespace),P(i)}function q(e){var t=e[0],i=new Image;return"undefined"!=typeof t.naturalHeight?{naturalHeight:t.naturalHeight,naturalWidth:t.naturalWidth}:"img"===t.tagName.toLowerCase()?(i.src=t.src,{naturalHeight:i.height,naturalWidth:i.width}):!1}function A(e){return e.indexOf("youtube.com")>-1||e.indexOf("youtu.be")>-1||e.indexOf("vimeo.com")>-1}var L=t.Plugin("lightbox",{widget:!0,defaults:{customClass:"",extensions:["jpg","sjpg","jpeg","png","gif"],fixed:!1,formatter:v,infinite:!1,labels:{close:"Close",count:"of",next:"Next",previous:"Previous",captionClosed:"View Caption",captionOpen:"Close Caption"},margin:50,minHeight:100,minWidth:100,mobile:!1,retina:!1,requestKey:"fs-lightbox",top:0,touch:!0,videoRatio:.5625,videoWidth:800},classes:["loading","animating","fixed","mobile","touch","inline","iframed","open","overlay","close","loading_icon","container","content","image","image_container","video","video_wrapper","tools","meta","controls","control","control_previous","control_next","control_disabled","position","position_current","position_total","caption_toggle","caption","caption_open","has_controls","has_caption","iframe","error","lock"],events:{open:"open",close:"close"},methods:{_setup:n,_construct:o,_destruct:r,_resize:a,resize:c},utilities:{_initialize:s,close:d}}),z=L.namespace,F=L.defaults,R=L.classes,B=R.raw,X=L.events,Y=L.functions,V=t.window,G=t.$window,U=null,Q=null,K=null}(jQuery,Formstone);